---
import { getCollection, getEntry, type CollectionEntry } from 'astro:content';

import MarkdownLayout from "src/layouts/MarkdownLayout.astro";
import type { Split } from 'src/utils/types';
export const prerender = true;

export async function getStaticPaths() {
  const collections = await getCollection("blog")
  return collections.map(({ slug }) => {
    const [blog_id, page] = slug.split("/") as Split<typeof slug, "/">;
    return {
      params: {
        blog_id,
        page
      }
    }
  })
}

const { blog_id, page } = Astro.params;
const thatPage = await getEntry("blog", `${blog_id}/${page}` as const);
const body = thatPage.body;
---

<MarkdownLayout title={thatPage.data.title} path={thatPage.slug} collection="blog">
  {body}
</MarkdownLayout>

